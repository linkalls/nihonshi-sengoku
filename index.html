<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Êà¶ÂõΩÂ§ßÂêçÂã¢ÂäõÂõ≥„ÉªÂàÜÂõΩÊ≥ï„Éû„ÉÉ„Éó</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel (JSXÂ§âÊèõÁî®) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Leaflet CSS & JS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@500;700&family=Yuji+Syuku&display=swap" rel="stylesheet">
    
    <!-- Lucide Icons (Á∞°ÊòìÁâàË™≠„ÅøËæº„Åø) -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        body { font-family: 'Zen Maru Gothic', sans-serif; background-color: #f5f5f4; }
        .serif-font { font-family: 'Yuji Syuku', serif; }
        .map-container { height: 100vh; width: 100%; z-index: 0; }
        
        /* „Ç´„Çπ„Çø„É†„Éû„Éº„Ç´„Éº„ÅÆ„Çπ„Çø„Ç§„É´ */
        .custom-div-icon {
            background: transparent;
            border: none;
        }
        .marker-pin {
            width: 40px;
            height: 40px;
            border-radius: 50% 50% 50% 0;
            background: #c30b82;
            position: absolute;
            transform: rotate(-45deg);
            left: 50%;
            top: 50%;
            margin: -20px 0 0 -20px;
            box-shadow: 0 3px 5px rgba(0,0,0,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid #fff;
        }
        .marker-pin::after {
            content: '';
            width: 24px;
            height: 24px;
            margin: 8px 0 0 8px;
            background: #fff;
            position: absolute;
            border-radius: 50%;
        }
        .marker-label {
            position: absolute;
            transform: rotate(45deg);
            font-family: 'Yuji Syuku', serif;
            font-weight: bold;
            font-size: 14px;
            color: #333;
            z-index: 10;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-left: 3px; 
            margin-top: 3px;
        }
        
        /* „Éù„ÉÉ„Éó„Ç¢„ÉÉ„ÉóË™øÊï¥ */
        .leaflet-popup-content-wrapper { padding: 0; overflow: hidden; border-radius: 8px; }
        .leaflet-popup-content { margin: 0; width: 280px !important; }

        /* „Çπ„ÇØ„É≠„Éº„É´„Éê„Éº */
        .scrollbar-thin::-webkit-scrollbar { width: 6px; }
        .scrollbar-thin::-webkit-scrollbar-thumb { background-color: #d6d3d1; border-radius: 3px; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- „Éá„Éº„Çø„Çª„ÉÉ„Éà (Anki„Éá„Éº„Çø„Å´Âü∫„Å•„Åè) ---
        const DAIMYO_DATA = [
            { id: 1, clan: "‰ºäÈÅîÊ∞è", old: "Èô∏Â••", now: "ÂÆÆÂüé/Á¶èÂ≥∂", law: "Â°µËä•ÈõÜ (171Êù°)", note: "171Êù°„Å´„ÇÇÂèä„Å∂ÂàÜÂõΩÊ≥ï„ÄéÂ°µËä•ÈõÜ„Äè„ÇíÂà∂ÂÆö„ÄÇ", lat: 38.2531, lng: 140.8556, color: "#1e3a8a" },
            { id: 2, clan: "ÂåóÊù°Ê∞è", old: "Áõ∏Ê®°", now: "Á•ûÂ•àÂ∑ù", law: "Êó©Èõ≤ÂØ∫ÊÆø‰∫åÂçÅ‰∏ÄÁÆáÊù°", note: "‰ºäÂã¢ÂÆóÁëû(Êó©Èõ≤)„ÅåÂ†ÄË∂äÂÖ¨Êñπ„ÇíÊªÖ„Åº„Åô„ÄÇÊ∞èÁ∂±„ÄÅÊ∞èÂ∫∑„Å®Á∂ö„Åè„ÄÇÂè§Ê≤≥ÂÖ¨Êñπ„ÇíÊíÉÁ†¥„ÄÇ", lat: 35.2510, lng: 139.1536, color: "#ca8a04" },
            { id: 3, clan: "‰∏äÊùâÊ∞è", old: "Ë∂äÂæå", now: "Êñ∞ÊΩü", law: "", note: "ÂÆàË≠∑‰ª£„ÅÆÈï∑Â∞æÊôØËôé„Åå‰∏äÊùâÊ∞è„ÇíÁ∂ô„Åé‰∏äÊùâË¨ô‰ø°„Å®„Å™„Çã„ÄÇÂ∑ù‰∏≠Â≥∂„ÅßÊ≠¶Áî∞„Å®Êà¶„ÅÜ„ÄÇ", lat: 37.1458, lng: 138.2236, color: "#581c87" },
            { id: 4, clan: "Ê≠¶Áî∞Ê∞è", old: "Áî≤Êñê", now: "Â±±Ê¢®", law: "Áî≤Â∑ûÊ≥ïÂ∫¶‰πãÊ¨°Á¨¨", note: "‰ø°ÁéÑÂ†§(ÈáúÁÑ°Â∑ù„ÅÆÊ≤ªÊ∞¥)„ÇÑÂàÜÂõΩÊ≥ï„ÄéÁî≤Â∑ûÊ≥ïÂ∫¶‰πãÊ¨°Á¨¨„Äè(ÂñßÂò©‰∏°ÊàêÊïó)„ÅßÊúâÂêç„ÄÇ", lat: 35.6865, lng: 138.5750, color: "#dc2626" },
            { id: 5, clan: "‰ªäÂ∑ùÊ∞è", old: "ÈßøÊ≤≥", now: "ÈùôÂ≤°", law: "‰ªäÂ∑ù‰ªÆÂêçÁõÆÈå≤", note: "‰ªäÂ∑ùÊ∞èË¶™„Åå„Äé‰ªäÂ∑ù‰ªÆÂêçÁõÆÈå≤„Äè„ÇíÂà∂ÂÆö„ÄÇÁæ©ÂÖÉ„ÅØ‰∏âÊ≤≥„ÉªÈÅ†Ê±ü„ÇÇÈ†òÂõΩÂåñ„ÄÇ", lat: 34.9789, lng: 138.3831, color: "#000000" },
            { id: 6, clan: "ÊñéËó§Ê∞è", old: "ÁæéÊøÉ", now: "Â≤êÈòú", law: "", note: "ÊñéËó§ÈÅì‰∏â„ÅåÂÆàË≠∑„ÅÆÂúüÂ≤êÊ∞è„ÇíËøΩÊîæ(‰∏ãÂâã‰∏ä)„ÄÇ", lat: 35.4339, lng: 136.7820, color: "#15803d" },
            { id: 7, clan: "ÊúùÂÄâÊ∞è", old: "Ë∂äÂâç", now: "Á¶è‰∫ï", law: "ÊúùÂÄâÂ≠ùÊôØÊù°„ÄÖ", note: "ÊñØÊ≥¢Ê∞è„ÅÆÂÆàË≠∑‰ª£Âá∫Ë∫´„ÄÇÂÆ∂Ë®ì„ÄéÊúùÂÄâÂ≠ùÊôØÊù°„ÄÖ„Äè„ÄÇ‰∏Ä‰πóË∞∑„ÅåÊã†ÁÇπ„ÄÇ", lat: 35.9968, lng: 136.2946, color: "#047857" },
            { id: 8, clan: "ÊµÖ‰∫ïÊ∞è", old: "ËøëÊ±ü(Âåó)", now: "ÊªãË≥Ä", law: "", note: "ÂÆàË≠∑„ÅÆ‰∫¨Ê•µÊ∞è„ÇíÊäº„Åï„Åà„Å¶Âè∞È†≠„ÄÇ", lat: 35.4578, lng: 136.2758, color: "#be123c" },
            { id: 9, clan: "ÂÖ≠ËßíÊ∞è", old: "ËøëÊ±ü(Âçó)", now: "ÊªãË≥Ä", law: "", note: "ËøëÊ±ü„ÅÆÂÆàË≠∑Â§ßÂêç„ÄÇ", lat: 35.1530, lng: 136.1600, color: "#7f1d1d" },
            { id: 10, clan: "‰∏âÂ•ΩÊ∞è", old: "ÈòøÊ≥¢", now: "Âæ≥Â≥∂", law: "Êñ∞Âä†Âà∂Âºè", note: "ÁÆ°È†òÁ¥∞Â∑ùÊô¥ÂÖÉ„ÇíËøΩÊîæ„ÄÇ‰∏âÂ•ΩÈï∑ÊÖ∂„ÅåÁïøÂÜÖ„ÇíÊîØÈÖç„ÄÇÂÆ∂Ëá£„ÅÆÊùæÊ∞∏‰πÖÁßÄ„Å´‰∏ãÂâã‰∏ä„Åï„Çå„Çã„ÄÇ", lat: 34.0720, lng: 134.5500, color: "#0d9488" },
            { id: 11, clan: "ÂåóÁï†Ê∞è", old: "‰ºäÂã¢", now: "‰∏âÈáç", law: "", note: "‰ºäÂã¢„ÅÆÂõΩÂè∏Âá∫Ë∫´„ÄÇ", lat: 34.5600, lng: 136.5000, color: "#475569" },
            { id: 12, clan: "Â§ßÂÜÖÊ∞è", old: "Âë®Èò≤", now: "Â±±Âè£", law: "", note: "‰∏≠ÂõΩÂú∞Êñπ„ÅÆË¶áËÄÖ„Å†„Å£„Åü„Åå„ÄÅÂÆ∂Ëá£„ÅÆÈô∂Êô¥Ë≥¢„Å´ÊªÖ„Åº„Åï„Çå„Çã„ÄÇ", lat: 34.1780, lng: 131.4730, color: "#b91c1c" },
            { id: 13, clan: "ÊØõÂà©Ê∞è", old: "ÂÆâËä∏", now: "Â∫ÉÂ≥∂", law: "", note: "ÂõΩ‰∫∫Âá∫Ë∫´„ÄÇÈô∂Êô¥Ë≥¢„ÇíÂÄí„Åó„ÄÅ‰∏≠ÂõΩÂú∞Êñπ„ÇíÁµ±‰∏Ä„ÄÇ", lat: 34.6989, lng: 132.7058, color: "#166534" },
            { id: 14, clan: "Â∞ºÂ≠êÊ∞è", old: "Âá∫Èõ≤", now: "Â≥∂Ê†π", law: "", note: "‰∫¨Ê•µÊ∞è„ÅÆÂÆàË≠∑‰ª£Âá∫Ë∫´„ÄÇÂ±±Èô∞Âú∞Êñπ„ÅßÊØõÂà©Ê∞è„Å®‰∫â„ÅÜ„ÄÇ", lat: 35.3621, lng: 133.1895, color: "#7e22ce" },
            { id: 15, clan: "Èï∑ÂÆóÊàëÈÉ®Ê∞è", old: "Âúü‰Ωê", now: "È´òÁü•", law: "", note: "Âúü‰Ωê„ÅÆÊà¶ÂõΩÂ§ßÂêç„ÄÇÂõõÂõΩ„ÇíÁµ±‰∏Ä„ÄÇ", lat: 33.5966, lng: 133.6441, color: "#4338ca" },
            { id: 16, clan: "Â§ßÂèãÊ∞è", old: "Ë±äÂæå", now: "Â§ßÂàÜ", law: "", note: "ÂÆàË≠∑Âá∫Ë∫´„ÄÇ„Ç≠„É™„Ç∑„Çø„É≥Â§ßÂêç„ÄÇ", lat: 33.2382, lng: 131.6126, color: "#b45309" },
            { id: 17, clan: "ÈæçÈÄ†ÂØ∫Ê∞è", old: "ËÇ•Ââç", now: "‰ΩêË≥Ä", law: "", note: "ËÇ•Ââç„ÅÆÊà¶ÂõΩÂ§ßÂêç„ÄÇ", lat: 33.2635, lng: 130.3009, color: "#831843" },
            { id: 18, clan: "Áõ∏ËâØÊ∞è", old: "ËÇ•Âæå", now: "ÁÜäÊú¨", law: "", note: "ËÇ•Âæå„ÅÆÊà¶ÂõΩÂ§ßÂêç„ÄÇ", lat: 32.2100, lng: 130.7600, color: "#0f766e" },
            { id: 19, clan: "Â≥∂Ê¥•Ê∞è", old: "Ëñ©Êë©", now: "ÈπøÂÖêÂ≥∂", law: "", note: "ÂÆàË≠∑Âá∫Ë∫´„ÄÇËñ©Êë©„ÅÆÊà¶ÂõΩÂ§ßÂêç„ÄÇ", lat: 31.5966, lng: 130.5571, color: "#000000" }
        ];

        // --- Leaflet Map Component ---
        const MapComponent = ({ selectedDaimyo, onMarkerClick }) => {
            const mapRef = useRef(null);
            const markersRef = useRef({});

            useEffect(() => {
                // Initialize Map
                if (!mapRef.current) {
                    mapRef.current = L.map('map').setView([36.0, 138.0], 5);
                    
                    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                        attribution: '&copy; OpenStreetMap contributors'
                    }).addTo(mapRef.current);
                }

                // Add Markers
                DAIMYO_DATA.forEach(daimyo => {
                    if (!markersRef.current[daimyo.id]) {
                        const icon = L.divIcon({
                            className: 'custom-div-icon',
                            html: `
                                <div style="background-color: ${daimyo.color}" class="marker-pin"></div>
                                <span class="marker-label">${daimyo.clan.charAt(0)}</span>
                            `,
                            iconSize: [30, 42],
                            iconAnchor: [15, 42],
                            popupAnchor: [0, -40]
                        });

                        const marker = L.marker([daimyo.lat, daimyo.lng], { icon })
                            .addTo(mapRef.current)
                            .bindPopup(`
                                <div class="font-sans p-3">
                                    <h3 class="font-bold text-lg border-b pb-1 mb-2 serif-font" style="color:${daimyo.color}">${daimyo.clan}</h3>
                                    <div class="text-xs text-gray-500 mb-2 font-bold">
                                        ${daimyo.old} <span class="text-gray-300">‚ñ∂</span> ${daimyo.now}
                                    </div>
                                    ${daimyo.law ? `<div class="bg-red-50 text-red-800 text-xs p-1 rounded mb-2 border border-red-200 font-bold">üìú ${daimyo.law}</div>` : ''}
                                    <p class="text-sm text-gray-700 leading-snug">${daimyo.note}</p>
                                </div>
                            `);
                        
                        marker.on('click', () => onMarkerClick(daimyo));
                        markersRef.current[daimyo.id] = marker;
                    }
                });
            }, []);

            // Fly to location
            useEffect(() => {
                if (selectedDaimyo && mapRef.current) {
                    mapRef.current.flyTo([selectedDaimyo.lat, selectedDaimyo.lng], 9, {
                        duration: 1.5
                    });
                    const marker = markersRef.current[selectedDaimyo.id];
                    if (marker) marker.openPopup();
                }
            }, [selectedDaimyo]);

            return <div id="map" className="w-full h-full"></div>;
        };

        // --- Main App ---
        const App = () => {
            const [selectedDaimyo, setSelectedDaimyo] = useState(null);
            const [isSidebarOpen, setSidebarOpen] = useState(true);

            // Lucide Icons setup
            useEffect(() => {
                lucide.createIcons();
            }, [isSidebarOpen]);

            return (
                <div className="flex h-screen w-full flex-col md:flex-row overflow-hidden">
                    {/* Header (Mobile) */}
                    <div className="md:hidden bg-stone-800 text-white p-3 flex justify-between items-center shadow-md z-20">
                        <h1 className="text-lg font-bold serif-font flex items-center gap-2">
                            <i data-lucide="map" class="w-5 h-5"></i> Êà¶ÂõΩÂ§ßÂêç„Éû„ÉÉ„Éó
                        </h1>
                        <button onClick={() => setSidebarOpen(!isSidebarOpen)}>
                            <i data-lucide={isSidebarOpen ? "x" : "menu"} class="w-6 h-6"></i>
                        </button>
                    </div>

                    {/* Sidebar */}
                    <div className={`
                        fixed md:relative z-10 h-full bg-white shadow-xl transition-transform duration-300 ease-in-out
                        ${isSidebarOpen ? 'translate-x-0 w-full md:w-80' : '-translate-x-full md:translate-x-0 md:w-0 md:overflow-hidden'}
                        flex flex-col
                    `}>
                        <div className="hidden md:flex bg-stone-800 text-white p-4 items-center justify-between shrink-0">
                            <h1 className="text-lg font-bold serif-font flex items-center gap-2">
                                <i data-lucide="scroll" class="w-5 h-5"></i> Êà¶ÂõΩÂ§ßÂêç„Éû„ÉÉ„Éó
                            </h1>
                        </div>

                        <div className="bg-yellow-50 p-2 text-xs text-yellow-800 border-b border-yellow-200 shrink-0">
                            <p className="flex items-center gap-1 font-bold">
                                <i data-lucide="info" class="w-3 h-3"></i>
                                <span className="text-red-600">Ëµ§Â≠ó</span>„ÅØÂàÜÂõΩÊ≥ï„ÅÇ„ÇäÔºÅ
                            </p>
                        </div>

                        <div className="flex-1 overflow-y-auto p-2 scrollbar-thin">
                            {DAIMYO_DATA.map(d => (
                                <div 
                                    key={d.id}
                                    onClick={() => {
                                        setSelectedDaimyo(d);
                                        if (window.innerWidth < 768) setSidebarOpen(false);
                                    }}
                                    className={`
                                        mb-2 p-3 rounded-lg border cursor-pointer transition-all hover:shadow-md
                                        flex items-center gap-3
                                        ${selectedDaimyo?.id === d.id ? 'bg-stone-100 border-stone-400' : 'bg-white border-stone-200'}
                                    `}
                                >
                                    <div className="w-8 h-8 rounded-full flex items-center justify-center text-white font-bold serif-font text-sm shrink-0 shadow-sm" style={{backgroundColor: d.color}}>
                                        {d.clan.charAt(0)}
                                    </div>
                                    <div className="flex-1 min-w-0">
                                        <div className="flex justify-between items-center">
                                            <span className="font-bold text-stone-800">{d.clan}</span>
                                            {d.law && <span className="text-[10px] bg-red-100 text-red-600 px-1 rounded border border-red-200 whitespace-nowrap">Ê≥ï</span>}
                                        </div>
                                        <div className="text-xs text-stone-500 truncate mt-0.5">
                                            {d.old} <span className="text-stone-300">‚ñ∂</span> {d.now}
                                        </div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>

                    {/* Map Area */}
                    <div className="flex-1 relative z-0">
                        {!isSidebarOpen && (
                            <button 
                                onClick={() => setSidebarOpen(true)}
                                className="absolute top-4 left-4 z-[1000] bg-white p-2 rounded shadow-md md:hidden"
                            >
                                <i data-lucide="menu" class="w-6 h-6"></i>
                            </button>
                        )}
                        <MapComponent selectedDaimyo={selectedDaimyo} onMarkerClick={setSelectedDaimyo} />
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
